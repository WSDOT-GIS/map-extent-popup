<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>Map</title>
	<link rel="stylesheet" href="//serverapi.arcgisonline.com/jsapi/arcgis/3.5/js/esri/css/esri.css">
	<style>
		html, body, #mapDiv {
			padding: 0;
			margin: 0;
			height: 100%;
		}
		.map-toolbar {
			position: absolute;
			top: 0;
			right: 0;
			padding-top: 0.5em;
			padding-right: 0.5em;
		}
		.map-toolbar button, #closeButton {
			font-size: 1em;
			font-family: 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', 'DejaVu Sans Condensed', sans-serif;
			padding: 1em;
		}

		#closeButton {
			position: absolute;
			bottom: 0;
			left: 50%;
			margin-bottom: 0.5em;
		}
	</style>
</head>
<body>
	<div id="mapDiv"></div>
	<script>
		var dojoConfig = {
			async: true,
			packages: [
				{
					name: "wsdot",
					location: "/Scripts/wsdot"
				}
			]
		};
	</script>
	<script src="//serverapi.arcgisonline.com/jsapi/arcgis/3.5/"></script>
	<script>
		require(["dojo/on", "wsdot/extentSelector", "esri/geometry/Extent"], function (on, ExtentSelector, Extent) {
			var extentSelector, extent;

			/** Retrieves the extent from the hash.  The extent should be provided as four numbers separated by commas.
			* @returns {esri.geometry.Extent}
			*/
			function getInitialExtent() {
				var extent, re = /#(\-?\d+(?:\.\d+)?),(\-?\d+(?:\.\d+)?),(\-?\d+(?:\.\d+)?),(\-?\d+(?:\.\d+)?)/i, match = location.hash.match(re);
				if (match) {
					extent = new Extent({
						xmin: Number(match[1]),
						ymin: Number(match[2]),
						xmax: Number(match[3]),
						ymax: Number(match[4]),
						spatialReference: {
							wkid: 3857
						}
					});
				}
			}

			extent = getInitialExtent();

			extentSelector = new ExtentSelector({
				initExtent: extent
			});
			window.extentSelector = extentSelector;
			on(extentSelector, "extent-change", function () {
				console.log(this, arguments);
			});
		});
	</script>
</body>
</html>
